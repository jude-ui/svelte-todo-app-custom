import{q as a,G as q,s as x,t as y,A}from"../common/index-61d85ae4.js";export{H as get}from"../common/index-61d85ae4.js";const u=[];function j(s,i){return{subscribe:g(s,i).subscribe}}function g(s,i=a){let o;const t=new Set;function f(n){if(y(s,n)&&(s=n,o)){const r=!u.length;for(const e of t)e[1](),u.push(e,s);if(r){for(let e=0;e<u.length;e+=2)u[e][0](u[e+1]);u.length=0}}}function l(n){f(n(s))}function b(n,r=a){const e=[n,r];return t.add(e),t.size===1&&(o=i(f)||a),n(s),()=>{t.delete(e),t.size===0&&(o(),o=null)}}return{set:f,update:l,subscribe:b}}function z(s,i,o){const t=!Array.isArray(s),f=t?[s]:s,l=i.length<2;return j(o,b=>{let n=!1;const r=[];let e=0,d=a;const m=()=>{if(e)return;d();const c=i(t?r[0]:r,b);l?b(c):d=A(c)?c:a},_=f.map((c,p)=>q(c,h=>{r[p]=h,e&=~(1<<p),n&&m()},()=>{e|=1<<p}));return n=!0,m(),function(){x(_),d()}})}export{z as derived,g as writable};
