import{q as f,F as y,z as q,s as x,y as z}from"../common/index-bb8214e0.js";export{G as get}from"../common/index-bb8214e0.js";const u=[];function j(s,i){return{subscribe:g(s,i).subscribe}}function g(s,i=f){let o;const t=new Set;function b(n){if(x(s,n)&&(s=n,o)){const r=!u.length;for(const e of t)e[1](),u.push(e,s);if(r){for(let e=0;e<u.length;e+=2)u[e][0](u[e+1]);u.length=0}}}function l(n){b(n(s))}function a(n,r=f){const e=[n,r];return t.add(e),t.size===1&&(o=i(b)||f),n(s),()=>{t.delete(e),t.size===0&&(o(),o=null)}}return{set:b,update:l,subscribe:a}}function A(s,i,o){const t=!Array.isArray(s),b=t?[s]:s,l=i.length<2;return j(o,a=>{let n=!1;const r=[];let e=0,d=f;const m=()=>{if(e)return;d();const c=i(t?r[0]:r,a);l?a(c):d=z(c)?c:f},_=b.map((c,p)=>y(c,h=>{r[p]=h,e&=~(1<<p),n&&m()},()=>{e|=1<<p}));return n=!0,m(),function(){q(_),d()}})}export{A as derived,g as writable};
